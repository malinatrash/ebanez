# Markov Chain Telegram Bot

Telegram бот, который учится общаться, анализируя сообщения в чате. Использует цепи Маркова для генерации текста и поддерживает работу со стикерами.

## Структура проекта

```
├── src/
│   ├── handlers/       # Обработчики команд и сообщений
│   └── services/       # Сервисы (генератор Маркова, БД, стикеры)
├── data/
│   ├── models/        # Сохраненные модели для каждого чата
│   ├── chats.db      # База данных сообщений
│   └── stickers.json # Сохраненные стикеры
├── .env               # Токен бота
├── main.py           # Точка входа
└── requirements.txt  # Зависимости
```

## Установка

1. Клонируйте репозиторий
2. Создайте виртуальное окружение:
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # для Linux/macOS
   .venv\Scripts\activate     # для Windows
   ```
3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
4. Создайте файл `.env` и добавьте токен бота:
   ```
   BOT_TOKEN=your_bot_token_here
   ```

## Запуск

```bash
python main.py
```

## Команды

- `/start` - начать общение с ботом
- `/help` - показать справку
- `/stats` - показать статистику чата
- `/gen` - сгенерировать случайное сообщение
- `/clear` - очистить память чата
- `/rebuild` - принудительно перестроить модель
- `/sticker` - отправить случайный стикер

## Как это работает

1. Бот собирает все текстовые сообщения и стикеры из чата
2. Строит модель на основе цепей Маркова после накопления минимального количества сообщений
3. Использует модель для генерации новых сообщений
4. Автоматически перестраивает модель каждые 10 новых сообщений
5. Хранит все данные в SQLite базе данных
6. Сохраняет отдельные модели для каждого чата

## Статистика

Бот предоставляет подробную статистику для каждого чата:
- Количество собранных сообщений
- Средняя длина сообщений
- Размер базы данных и модели
- Статус модели (создана/не создана/недостаточно данных)
- Количество сообщений до следующей перестройки

## Docker

Проект можно запустить в Docker контейнере:

```bash
docker-compose up -d
